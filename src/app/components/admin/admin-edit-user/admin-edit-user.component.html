<div class="edit-container">
  <h2>Edit User Profile</h2>
  <div *ngIf="isLoading">Loading...</div>
  <div *ngIf="error" class="error-message">{{error}}</div>
  
  <form *ngIf="userForm" [formGroup]="userForm" (ngSubmit)="onSubmit()">
    <div class="form-section">
      <h3>Basic Information</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>Username</label>
          <input type="text" formControlName="username" readonly>
        </div>
        <div class="form-group">
          <label>Email</label>
          <input type="email" formControlName="email" readonly>
        </div>
        <div class="form-group">
          <label>Status</label>
          <select formControlName="status">
            <option value="active">Active</option>
            <option value="suspended">Suspended</option>
            <option value="pending">Pending</option>
          </select>
        </div>
        <div class="form-group">
          <label>Profile Level</label>
          <select formControlName="profileLevel">
            <option value="free">Free</option>
            <option value="standard">Standard</option>
            <option value="premium">Premium</option>
            <option value="vip">VIP</option>
          </select>
        </div>
      </div>
    </div>

    <div class="form-section">
      <h3>Media</h3>
      <div class="media-grid">
        <div class="media-section">
          <h4>Profile Picture</h4>
          <img *ngIf="profile?.profilePicture" 
               [src]="getMediaUrl(profile?.profilePicture!)" 
               alt="Profile" 
               (click)="openPreview(profile?.profilePicture!)">
        </div>
        <div class="media-section">
          <h4>Images ({{profile?.images?.length || 0}})</h4>
          <div class="image-grid">
            <div *ngFor="let image of profile?.images" class="image-item">
              <img [src]="getMediaUrl(image)" alt="Gallery" (click)="openPreview(image)">
            </div>
          </div>
        </div>
        <div class="media-section">
          <h4>Videos ({{profile?.videos?.length || 0}})</h4>
          <div class="video-grid">
            <div *ngFor="let video of profile?.videos" class="video-item">
              <video [src]="getMediaUrl(video)" controls></video>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="form-section">
      <h3>Verification</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>Verification Status</label>
          <select formControlName="verificationStatus">
            <option value="unverified">Unverified</option>
            <option value="pending">Pending</option>
            <option value="verified">Verified</option>
            <option value="rejected">Rejected</option>
          </select>
        </div>
        <div class="media-section">
          <h4>Verification Documents</h4>
          <div class="doc-grid">
            <div *ngFor="let doc of profile?.verificationDocuments" class="doc-item">
              <img [src]="getMediaUrl(doc.data)" alt="Document" (click)="openPreview(doc.data)">
              <span>{{doc.side}} side</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="form-section">
      <h3>Moderation</h3>
      <div class="form-grid">
        <div class="form-group">
          <label>Content Warnings</label>
          <textarea formControlName="contentWarnings" rows="3"></textarea>
        </div>
        <div class="form-group">
          <label>Reviewer Notes</label>
          <textarea formControlName="reviewerNotes" rows="3"></textarea>
        </div>
      </div>
    </div>

    <div class="form-actions">
      <button type="submit" [disabled]="userForm.invalid || isSaving">
        {{isSaving ? 'Saving...' : 'Save Changes'}}
      </button>
      <button type="button" class="cancel-btn" (click)="onCancel()">Cancel</button>
    </div>
  </form>
</div>

<div *ngIf="previewUrl" class="preview-overlay" (click)="closePreview()">
  <div class="preview-content">
    <img [src]="previewUrl" alt="Preview">
  </div>
</div>