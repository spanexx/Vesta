<div class="profile-detail-container">
  <div *ngIf="isLoading" class="loading-state">
    <app-custom-spinner></app-custom-spinner>
  </div>

  <div *ngIf="error" class="error-message">
    {{ error }}
  </div>
  <div *ngIf="profile && !isLoading" class="profile-content">
    <div class="profile-top-section">
      <!-- Profile Picture Section -->
      <div class="profile-picture-section">
        <div class="profile-picture">
          <img [src]="profile.profilePicture" [alt]="profile.fullName">
        </div>
      </div>

      <div class="profile-right-section">

        <!-- Header Section -->
        <div class="profile-header">
          <div class="editable-field" (click)="startEditing('fullName', profile.fullName || '')" *ngIf="profile">
            <h1 *ngIf="editingField !== 'fullName'">{{profile.fullName || 'No name provided'}}</h1>
            <div *ngIf="editingField === 'fullName'" class="edit-controls">
              <input type="text" [(ngModel)]="tempEditValue" (keyup.enter)="saveField('fullName')" (keyup.escape)="cancelEditing()">
              <div class="edit-buttons">
                <button (click)="saveField('fullName')" class="save-btn">Save</button>
                <button (click)="cancelEditing()" class="cancel-btn">Cancel</button>
              </div>
            </div>
          </div>

          <p class="username">
              {{  '@' + profile.username}}
            <i *ngIf="profile.verified" class="fas fa-gem verified-badge"><i class="fas fa-check verified-badge"></i></i>
          </p>
          <p class="birthday" *ngIf="profile.birthdate">Age: {{formatBirthday(profile.birthdate)}}</p>
            <div class="bio" (click)="startEditing('bio', profile.bio || '')" *ngIf="profile">
              <p *ngIf="editingField !== 'bio'">Bio: <span>{{profile.bio || 'No bio provided'}}</span></p>
              <div *ngIf="editingField === 'bio'" class="edit-controls">
                <textarea [(ngModel)]="tempEditValue" (keyup.enter)="saveField('bio')" (keyup.escape)="cancelEditing()"></textarea>
                <div class="edit-buttons">
                  <button (click)="saveField('bio')" class="save-btn">Save</button>
                  <button (click)="cancelEditing()" class="cancel-btn">Cancel</button>
                </div>
              </div>
            </div>

        </div>
      </div>
      <div>
        
      <div class="profile-badges">
        <span class="badge level" [ngClass]="{
          'level-standard': profile.profileLevel.toLowerCase() === 'standard',
          'level-premium': profile.profileLevel.toLowerCase() === 'premium',
          'level-vip': profile.profileLevel.toLowerCase() === 'vip'
        }">
          {{profile.profileLevel}}
          <i *ngIf="profile.profileLevel.toLowerCase() === 'vip'" class="fas fa-star vip-star"></i>
        </span>
        <span class="badge status" [ngClass]="{
          'status-active': profile.status === 'active',
          'status-suspended': profile.status === 'suspended',
          'status-pending': profile.status === 'pending'
        }">{{profile.status}}</span>
        <span *ngIf="isCurrentUser" class="badge settings" routerLink="/settings"><i class="fas fa-magic"></i></span>

      </div>
      <div class="like-buttons-section">
        <button (click)="addUserLike()" class="like-button user-like">
          <i class="fas fa-heart"></i>
          <span>{{profile.userlikes || 0}}</span>
        </button>
        <button (click)="addViewerLike()" class="like-button viewer-like">
          <i class="fas fa-eye"></i>
          <span>{{profile.viewerlikes || 0}}</span>
        </button>
      </div>
    </div>
    </div>

    <!-- Image Gallery -->
    <div class="image-gallery">
      <div class="main-images" *ngIf="profile.images?.length">
        <div class="gallery-item" *ngFor="let image of profile.images">
          <img [src]="image" [alt]="profile.fullName" (click)="openImageModal(image)">
        </div>
      </div>
      <div class="videos" *ngIf="profile.videos?.length">
        <div class="gallery-item" *ngFor="let video of profile.videos">
          <video controls>
            <source [src]="video" type="video/mp4">
          </video>
        </div>
      </div>
    </div>

    <!-- Bio Section -->
    <div class="bio-section">
      <h2>Role</h2>
      <p class="role">{{profile.role}}</p>
    </div>

    <!-- Services Section -->
    <div class="services-section" *ngIf="profile.services?.length">
      <h2>Services</h2>
      <ul class="services-list">
        <li *ngFor="let service of profile.services">{{service}}</li>
      </ul>
    </div>

    <!-- Physical Attributes -->
    <div class="attributes-section" *ngIf="profile.physicalAttributes">
      <h2>Physical Attributes</h2>
      <div class="attributes-grid">
        <div *ngIf="profile.physicalAttributes.gender" class="attribute">
          <span class="label">Gender:</span> {{profile.physicalAttributes.gender}}
        </div>
        <div *ngIf="profile.physicalAttributes.height" class="attribute">
          <span class="label">Height:</span> {{profile.physicalAttributes.height}}cm
        </div>
        <div *ngIf="profile.physicalAttributes.weight" class="attribute">
          <span class="label">Weight:</span> {{profile.physicalAttributes.weight}}kg
        </div>
        <div *ngIf="profile.physicalAttributes.ethnicity" class="attribute">
          <span class="label">Ethnicity:</span> {{profile.physicalAttributes.ethnicity}}
        </div>
        <div *ngIf="profile.physicalAttributes.bustSize" class="attribute">
          <span class="label">Bust Size:</span> {{profile.physicalAttributes.bustSize}}
        </div>
        <div *ngIf="profile.physicalAttributes.bustType" class="attribute">
          <span class="label">Bust Type:</span> {{profile.physicalAttributes.bustType}}
        </div>
        <div *ngIf="profile.physicalAttributes.pubicHair" class="attribute">
          <span class="label">Pubic Hair:</span> {{profile.physicalAttributes.pubicHair}}
        </div>
        <div class="attribute">
          <span class="label">Tattoos:</span> {{profile.physicalAttributes.tattoos ? 'Yes' : 'No'}}
        </div>
        <div class="attribute">
          <span class="label">Piercings:</span> {{profile.physicalAttributes.piercings ? 'Yes' : 'No'}}
        </div>
      </div>
    </div>

    <!-- Availability Section -->
    <div class="availability-section" *ngIf="profile.availableToMeet">
      <h2>Availability</h2>
      <div class="availability-details">
        <p *ngIf="profile.availableToMeet.available24_7">Available 24/7</p>
        <p *ngIf="profile.availableToMeet.advanceBooking">Advance Booking Available</p>
        <div *ngIf="profile.availableToMeet.meetingWith?.length">
          <h3>Meeting With:</h3>
          <ul>
            <li *ngFor="let meetWith of profile.availableToMeet.meetingWith">{{meetWith}}</li>
          </ul>
        </div>
        <p *ngIf="profile.workingTime">Working Hours: {{profile.workingTime}}</p>
      </div>
    </div>

    <!-- Contact Information -->
    <div class="contact-section" *ngIf="profile.contact">
      <h2>Contact Information</h2>
      <div class="contact-details">
        <p *ngIf="profile.contact.phone">Phone: {{profile.contact.phone}}</p>
        <p *ngIf="profile.contact.country">Country: {{profile.contact.country}}</p>
        <p *ngIf="profile.contact.city">City: {{profile.contact.city}}</p>
        <p *ngIf="profile.contact.city">Email: {{profile.email}}</p>
      </div>
    </div>

    <!-- Additional Information -->
    <div class="additional-info">
      <div class="rates" *ngIf="rates.incall || rates.outcall">
        <h2>Rates</h2>
        <table class="rates-table">
          <thead>
            <tr>
              <th>Duration</th>
              <th>Incall</th>
              <th>Outcall</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>30 minutes</td>
              <td>{{ rates.incall?.['30 minutes'] ? '$' + rates.incall['30 minutes'] : 'N/A' }}</td>
              <td>{{ rates.outcall?.['30 minutes'] ? '$' + rates.outcall['30 minutes'] : 'N/A' }}</td>
            </tr>
            <tr>
              <td>1 hour</td>
              <td>{{ rates.incall?.['1 hour'] ? '$' + rates.incall['1 hour'] : 'N/A' }}</td>
              <td>{{ rates.outcall?.['1 hour'] ? '$' + rates.outcall['1 hour'] : 'N/A' }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>


  <!-- Add this at the bottom of your component -->
  <div class="image-modal" *ngIf="selectedImage" (click)="closeImageModal()">
    <div class="modal-content">
      <span class="close-button" (click)="closeImageModal()">&times;</span>
      <img [src]="selectedImage" alt="Full size image">
    </div>
  </div>
</div>
